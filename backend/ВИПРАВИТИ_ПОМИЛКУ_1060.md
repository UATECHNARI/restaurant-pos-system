# üîß –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ 1060 (Duplicate column name 'client_id')

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:

```
Error Code: 1060. Duplicate column name 'client_id'
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–ª–æ–Ω–∫–∞ `client_id` –≤–∂–µ —ñ—Å–Ω—É—î –≤ —Ç–∞–±–ª–∏—Ü—ñ `users`, –∞–ª–µ SQL —Å–∫—Ä–∏–ø—Ç –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –¥–æ–¥–∞—Ç–∏ —ó—ó –∑–Ω–æ–≤—É.

---

## ‚úÖ –†–Ü–®–ï–ù–ù–Ø:

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∏–π SQL —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

**PowerShell:**
```powershell
cd D:\Work\Pizza\backend
Get-Content fix-multi-tenancy.sql | mysql -u root -p bar_kitchen_pos
```

**MySQL Workbench:**
1. –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª `fix-multi-tenancy.sql`
2. –í–∏–∫–æ–Ω–∞—Ç–∏ (F9)

**–©–æ —Ä–æ–±–∏—Ç—å —Ü–µ–π —Å–∫—Ä–∏–ø—Ç:**
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ —ñ—Å–Ω—É—î –∫–æ–∂–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ –ø–µ—Ä–µ–¥ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ —ñ—Å–Ω—É—î –∫–æ–∂–µ–Ω —ñ–Ω–¥–µ–∫—Å –ø–µ—Ä–µ–¥ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ —ñ—Å–Ω—É—î foreign key –ø–µ—Ä–µ–¥ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º
- ‚úÖ –ú–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤ –±–µ–∑ –ø–æ–º–∏–ª–æ–∫

---

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Ä—É—á–Ω—É —â–æ –≤–∂–µ —î

**–í–∏–∫–æ–Ω–∞—Ç–∏ –≤ MySQL:**
```sql
USE bar_kitchen_pos;

-- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ —î client_id –≤ users
DESCRIBE users;

-- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ —î foreign key
SHOW CREATE TABLE users;
```

**–Ø–∫—â–æ –∫–æ–ª–æ–Ω–∫–∞ `client_id` –≤–∂–µ —î, –∞–ª–µ –Ω–µ–º–∞—î foreign key:**
```sql
-- –î–æ–¥–∞—Ç–∏ foreign key (—è–∫—â–æ —â–µ –Ω–µ–º–∞—î)
ALTER TABLE users 
ADD CONSTRAINT fk_users_client 
FOREIGN KEY (client_id) REFERENCES clients(id) ON DELETE CASCADE;
```

---

### –í–∞—Ä—ñ–∞–Ω—Ç 3: –í–∏–∫–æ–Ω–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏

**–î–æ–¥–∞—Ç–∏ foreign key (—è–∫—â–æ —â–µ –Ω–µ–º–∞—î):**
```sql
USE bar_kitchen_pos;

-- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ —ñ—Å–Ω—É—î foreign key
SELECT 
    CONSTRAINT_NAME,
    TABLE_NAME,
    COLUMN_NAME,
    REFERENCED_TABLE_NAME,
    REFERENCED_COLUMN_NAME
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE 
WHERE TABLE_SCHEMA = 'bar_kitchen_pos' 
AND TABLE_NAME = 'users' 
AND COLUMN_NAME = 'client_id';

-- –Ø–∫—â–æ –Ω–µ–º–∞—î - –¥–æ–¥–∞—Ç–∏
ALTER TABLE users 
ADD CONSTRAINT fk_users_client 
FOREIGN KEY (client_id) REFERENCES clients(id) ON DELETE CASCADE;
```

---

## üìã –©–û –¢–ï–ü–ï–† –†–û–ë–ò–¢–ò:

### 1. –í–∏–∫–æ–Ω–∞—Ç–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∏–π SQL —Å–∫—Ä–∏–ø—Ç:

```powershell
Get-Content fix-multi-tenancy.sql | mysql -u root -p bar_kitchen_pos
```

### 2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```sql
DESCRIBE users;
DESCRIBE products;
DESCRIBE tables;
DESCRIBE orders;
```

### 3. –ú—ñ–≥—Ä—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:

```powershell
npm run migrate:users
```

### 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ backend:

```powershell
npm run dev
```

---

## ‚úÖ –ü–Ü–°–õ–Ø –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø:

1. ‚úÖ –¢–∞–±–ª–∏—Ü—è `clients` —Å—Ç–≤–æ—Ä–µ–Ω–∞
2. ‚úÖ –ö–æ–ª–æ–Ω–∫–∞ `client_id` —î –≤ `users` (–±–µ–∑ –ø–æ–º–∏–ª–∫–∏ duplicate)
3. ‚úÖ Foreign key –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π
4. ‚úÖ –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –ø—Ä–∞—Ü—é—î
5. ‚úÖ –¢–æ–≤–∞—Ä–∏ —Ç–∞ —Å—Ç–æ–ª–∏ –¥–æ–¥–∞—é—Ç—å—Å—è

---

**–§–∞–π–ª –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç—É:** `fix-multi-tenancy.sql`

